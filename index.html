<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>æ’®å½±æœ¬ç•ªï¼ˆMain Scanï¼‰éŸ³å£°ã‚¬ã‚¤ãƒ‰</title>
<style>
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Hiragino Sans","Segoe UI",sans-serif;
background:linear-gradient(180deg,#f7fbff,#eef6ff);color:#0f172a;}
.header{padding:18px 16px 10px;}
.frame-title{border:2px solid #38bdf8;padding:14px 16px;border-radius:14px;background:#f8fcff;text-align:center;}
.frame-title h1{margin:0;font-size:20px;}
.frame-title p{margin:6px 0 0;font-size:14px;color:#475569;}
.note{font-size:12px;color:#475569;margin:12px 16px;}
.main{margin:0 16px 24px;padding:16px;background:#fff;border-radius:18px;box-shadow:0 8px 18px rgba(15,23,42,.08);}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap;}
select{flex:1;max-width:100%;font-size:16px;padding:10px 36px 10px 12px;border-radius:12px;border:1px solid #cbd5f5;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
button{font-size:15px;padding:10px 14px;border-radius:12px;border:1px solid #cbd5f5;background:#eff6ff;}
button:active{transform:scale(.98);}
.label{margin-top:14px;font-size:13px;color:#475569;}
.jp{font-size:18px;font-weight:600;margin-top:6px;}
.en{font-size:16px;margin-top:4px;}
.controls{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px;}
audio{width:100%;margin-top:10px;}
.status{margin-top:8px;font-size:13px;color:#475569;}
.hint{margin-top:10px;font-size:12px;color:#64748b;}

/* === Emergency Button (Main Scan only) === */
.fab-emg{position:fixed;right:16px;bottom:16px;z-index:10000;
background:#fff1f2;border:1px solid #fecaca;color:#9f1239;
border-radius:999px;padding:12px 14px;font-weight:800}
.emg-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.4);
z-index:9998;display:none}
.emg-sheet{position:fixed;left:0;right:0;bottom:0;z-index:9999;
display:none;padding:12px}
.emg-panel{max-width:720px;margin:0 auto;background:#fff;
border-radius:18px;padding:14px}
.emg-item{border:1px solid #e2e8f0;border-radius:14px;
padding:10px;margin-bottom:8px}
.emg-jp{font-weight:700;font-size:16px}
.emg-en{font-size:13px;color:#475569}


/* === Implant Device Sheet (same structure as Emergency) === */
.fab-dev{position:fixed;left:16px;bottom:16px;z-index:10000;
background:#f0f9ff;border:1px solid #bae6fd;color:#075985;
border-radius:999px;padding:12px 14px;font-weight:800}
.dev-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.4);
z-index:9998;display:none}
.dev-sheet{position:fixed;left:0;right:0;bottom:0;z-index:9999;
display:none;padding:12px}
.dev-panel{max-width:720px;margin:0 auto;background:#fff;
border-radius:18px;padding:14px}
.dev-item{border:1px solid #e2e8f0;border-radius:14px;
padding:10px;margin-bottom:8px}
.dev-jp{font-weight:700;font-size:16px}
.dev-en{font-size:13px;color:#475569}
.dev-title{font-weight:800;margin-bottom:10px}

</style>
</head>
<body data-page="main-scan">
<div class="header">
  <div class="frame-title">
    <h1>æ’®å½±æœ¬ç•ªï¼ˆMain Scanï¼‰</h1>
    <p>English Audio Guide</p>
  </div>
</div>

<p class="note">â€» iPhone / iPad / Android ã§å†ç”Ÿã§ãã¾ã™ã€‚æœ€åˆã¯ã€Œå†ç”Ÿã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</p>

<div class="main">
  <div class="row">
    <select id="sel"></select>
    <button id="prev">â† å‰</button>
    <button id="next">æ¬¡ â†’</button>
  </div>

  <div class="label">æ—¥æœ¬èªï¼ˆå†…å®¹ï¼‰</div>
  <div class="jp" id="jp"></div>

  <div class="label">English (Script)</div>
  <div class="en" id="en"></div>

  <div class="controls">
    <button id="play">â–¶ï¸ å†ç”Ÿ</button>
    <button id="pause">â¸ ä¸€æ™‚åœæ­¢</button>
    <button id="replay">â†» ã‚‚ã†ä¸€åº¦</button>
  </div>

  <div class="status" id="status">å¾…æ©Ÿä¸­ / Ready</div>
  <audio id="player" controls></audio>

  <div class="hint">
    å†ç”Ÿã§ããªã„å ´åˆï¼šæ¶ˆéŸ³ãƒ¢ãƒ¼ãƒ‰è§£é™¤ã€éŸ³é‡ã€Bluetoothæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚
  </div>
</div>

<script>
const STEPS = [
 {preview:"ã¾ã‚‚ãªãé€ å½±å‰¤ã‚’æ³¨å°„ã—ã¾ã™â€¦", jp:"ã¾ã‚‚ãªãé€ å½±å‰¤ã‚’æ³¨å°„ã—ã¾ã™ã€‚", en:"We're going to inject the contrast dye soon."},
 {preview:"æ°—åˆ†ãŒæ‚ªããªã£ãŸã‚‰â€¦", jp:"æ°—åˆ†ãŒæ‚ªããªã£ãŸã‚‰ã€ã™ãã«æ•™ãˆã¦ãã ã•ã„ã€‚", en:"If you feel sick, please let us know right away."},
 {preview:"ä»Šã‹ã‚‰æ³¨å…¥ã‚’é–‹å§‹ã—ã¾ã™â€¦", jp:"ä»Šã‹ã‚‰æ³¨å…¥ã‚’é–‹å§‹ã—ã¾ã™ã€‚ç—›ã¿ã¯ã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿæ°—åˆ†ã¯ã„ã‹ãŒã§ã™ã‹ï¼Ÿ", en:"Starting the injection now. Did you feel any pain? How are you feeling?"},
 {preview:"ã ã‚“ã ã‚“æ¸©ã‹ãæ„Ÿã˜ã¾ã™â€¦", jp:"ã ã‚“ã ã‚“ä½“ãŒæ¸©ã‹ãæ„Ÿã˜ã¦ãã¾ã™ã€‚", en:"You'll start to feel warm gradually."},
 {preview:"æ¯æ­¢ã‚ã®åˆå›³ã®å¾Œâ€¦", jp:"æ¯æ­¢ã‚ã®åˆå›³ãŒèã“ãˆãŸã‚‰ã€ã™ãã«æ’®å½±ãŒå§‹ã¾ã‚Šã¾ã™ã€‚", en:"After you hear the instruction to hold your breath, the scan will start right away."},
 {preview:"ç´„1åˆ†å¾Œã«å†åº¦æ’®å½±â€¦", jp:"ç´„1åˆ†å¾Œã«ã€ã‚‚ã†ä¸€åº¦æ’®å½±ã—ã¾ã™ã€‚æ°—åˆ†ã¯ã„ã‹ãŒã§ã™ã‹ï¼Ÿ", en:"In about one minute, we're going to take another scan. How are you feeling?"},
 {preview:"æ¸©ã‹ã„æ„Ÿã˜ã¯æ•°åˆ†ã§â€¦", jp:"æ¸©ã‹ã„æ„Ÿã˜ã¯æ•°åˆ†ã§ãŠã•ã¾ã‚Šã¾ã™ã€‚", en:"The warm sensation will go away in a few minutes."}
];

const sel=document.getElementById('sel'),
jp=document.getElementById('jp'),
en=document.getElementById('en'),
player=document.getElementById('player'),
status=document.getElementById('status');

STEPS.forEach((s,i)=>{
 const o=document.createElement('option');
 o.value=i;
 o.textContent=`${String(i+1).padStart(2,'0')}ï½œ${s.jp}`;
 sel.appendChild(o);
});

let idx=0;
function load(i){
 idx=Math.max(0,Math.min(STEPS.length-1,i));
 sel.value=idx;
 jp.textContent=STEPS[idx].jp;
 en.textContent=STEPS[idx].en;
 player.src=`audio/step_${String(idx+1).padStart(2,'0')}.m4a`;
 status.textContent="å¾…æ©Ÿä¸­ / Ready";
}
sel.onchange=()=>load(parseInt(sel.value));
document.getElementById('prev').onclick=()=>load(idx-1);
document.getElementById('next').onclick=()=>load(idx+1);
document.getElementById('play').onclick=()=>player.play();
document.getElementById('pause').onclick=()=>player.pause();
document.getElementById('replay').onclick=()=>{player.currentTime=0;player.play();}
player.onplay=()=>status.textContent="å†ç”Ÿä¸­ / Playing";
player.onpause=()=>status.textContent="ä¸€æ™‚åœæ­¢ / Paused";
player.onended=()=>status.textContent="å¾…æ©Ÿä¸­ / Ready";
load(0);

document.addEventListener('DOMContentLoaded',()=>{
 if(document.body.dataset.page!=='main-scan')return;

 const EMG=[
  {jp:'èã“ãˆã¾ã™ã‹ï¼Ÿæ„è­˜ã¯ã¯ã£ãã‚Šã—ã¦ã„ã¾ã™ã‹ï¼Ÿ',en:'Can you hear me? Are you okay?',a:'audio/emergency_01.m4a'},
  {jp:'æ¯è‹¦ã—ã•ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ',en:'Are you having difficulty breathing?',a:'audio/emergency_02.m4a'},
  {jp:'ã©ã“ã‹ç—’ã¿ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ',en:'Do you feel itchy anywhere?',a:'audio/emergency_03.m4a'},
  {jp:'ã‚ã¾ã„ã‚„ãµã‚‰ã¤ãã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ',en:'Do you feel dizzy or lightheaded?',a:'audio/emergency_04.m4a'},
  {jp:'åãæ°—ã‚„ã€åããã†ãªæ„Ÿã˜ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ',en:'Do you have nausea or feel like vomiting?',a:'audio/emergency_05.m4a'},
  {jp:'å–‰ãŒç· ã‚ä»˜ã‘ã‚‰ã‚Œã‚‹æ„Ÿã˜ã€ã¾ãŸã¯è©°ã¾ã‚‹æ„Ÿã˜ã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿ',en:'Does your throat feel tight?',a:'audio/emergency_06.m4a'}
 ];

 const open=document.getElementById('emgOpen');
 const back=document.getElementById('emgBackdrop');
 const sheet=document.getElementById('emgSheet');
 const list=document.getElementById('emgList');
 const player=document.getElementById('emgPlayer');
 const close=document.getElementById('emgClose');

 EMG.forEach((s,i)=>{
  const d=document.createElement('div');d.className='emg-item';
  d.innerHTML=`<div class="emg-jp">${i+1}. ${s.jp}</div>
               <div class="emg-en">${s.en}</div>`;
  d.onclick=()=>{player.src=s.a;player.play();}
  list.appendChild(d);
 });

 open.onclick=()=>{back.style.display='block';sheet.style.display='block'};
 back.onclick=close.onclick=()=>{back.style.display='none';sheet.style.display='none'};
});

</script>

<button class="fab-emg" id="emgOpen">âš  æ€¥å¤‰æ™‚ç¢ºèª</button>
<div class="emg-backdrop" id="emgBackdrop"></div>
<div class="emg-sheet" id="emgSheet">
  <div class="emg-panel">
    <div id="emgList"></div>
    <audio id="emgPlayer" controls style="width:100%"></audio>
    <button id="emgClose">é–‰ã˜ã‚‹</button>
  </div>
</div>


<button class="fab-dev" id="devOpen">ğŸ“Ÿ æ¤ãˆè¾¼ã¿ãƒ‡ãƒã‚¤ã‚¹</button>
<div class="dev-backdrop" id="devBackdrop"></div>
<div class="dev-sheet" id="devSheet">
  <div class="dev-panel">
    <div class="dev-title">æ¤ãˆè¾¼ã¿ãƒ‡ãƒã‚¤ã‚¹ãŒã‚ã‚‹å ´åˆ / If you have an implanted heart device</div>
    <div id="devList"></div>
    <audio id="devPlayer" controls style="width:100%"></audio>
    <button id="devClose">é–‰ã˜ã‚‹</button>
  </div>
</div>


</body>
</html>
